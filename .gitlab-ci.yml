stages:
    - test
    - build
    - deploy

image: registry.gitlab.com/tokenmill/nlg/accelerated-text/demo-test-env:latest

test:preact_demo:
    script:
        - make test
    stage:  test

job:npm_audit:
    only:
        - schedules
    script:
        - make npm-audit

lexical-analysis:code-linter:
  image: registry.gitlab.com/tokenmill/nlg/accelerated-text/pytest:latest
  stage: test
  when: on_success
  script:
    - flake8 lexical-analyser/api
    - flake8 lexical-analyser/core


deploy-app:
    stage:  deploy
    when:   on_success
    only:
       - master
    script:
        - make deploy-app
